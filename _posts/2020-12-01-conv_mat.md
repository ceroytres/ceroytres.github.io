# Convolution, Circulant Matrices, and Graphs! 

## __INCOMPLETE__


## Convolution

Perhaps the most ubiquitous operation in digital signal processing is the application of filters on signals via convolution. The convolution operation is defined as:

$$ y[n] =(h * x)[n] = \sum_{m=0}^{N} h[n-m] x[m] $$

where $x[n]$ is the input signal of length $P$, $h[n]$ is the filter of length $L$, $N = P + L - 1$, and $n \in \mathbb{Z}$ is the time step.

### Properties:

1. Linearity: 

$$c_1x_1[n] * h[n] + c_2x_2[n] * h[n] = (c_1x_1[n] + c_2x_2[n]) * h[n]$$

2. Commutivity:

$$x[n] * h[n] = h[n] * x[n]$$


## Delta function 

An interesting function is the delta function which is defined as: 
$$
\delta[n] =
    \begin{cases}
            1, &         \text{if } n = 0,\\
            0, &         \text{if } n \neq 0
    \end{cases}
$$

The delta function has an identity property under convolution:

$$ x[n] = x[n] * \delta[n] $$

Similarly a shifted delta function yields a shifted copy of the input sequence:

$$ x[n - m] = x[n] * \delta[n - m] $$

Any finite sequence $x[n]$ of length $N_x$ can be represented

## Circular Convolution

A related operation is circular convolution: 

$$ y[n] = x[n] \circledast h[n] = \sum_{m=0}^{N-1} h[(n-m)\text{ mod } N] x[m] $$

Circular Convolution can be used to compute regular convolution (sometimes called linear convolution) if $x$ and $h$ are padded with zeros such that the new lengths equal $N_x + N_h - 1$. 



## Fourier Transform


The Discrete Fourier Transform (DFT) of a signal $x[n]$ of length $N$ is defined as <a href="#ref_2">[1]</a> :

__Analysis__

$$X[k] = \frac{1}{\sqrt{N}} \sum_{n = 0}^{N-1} x[n] W_N^{kn}$$

__Synthesis__

$$x[n] = \frac{1}{\sqrt{N}} \sum_{n = 0}^{N-1} X[k] {W_N^*}^{kn}$$


where $W_N = e^{-j\frac{2\pi}{N}}$, $W_N^* = e^{j\frac{2\pi}{N}}$, and $0 \le k \le N-1$

The analysis portion of the DFT can be seen as a matrix muplication:


$$ X[0] = \frac{1}{\sqrt{N}}(x[0] + x[1] + x[2]... + x[N-1]) $$

$$ X[1] = \frac{1}{\sqrt{N}}(x[0] + x[1]W_N + x[2]W_N^2... + x[N-1]W_N^{N-1}) $$

$$ \vdots $$

$$ X[N-1] = \frac{1}{\sqrt{N}}(x[0] + x[1]W_N^{N-1} +x[2]W_N^{2(N-1)} + ... x[N-1]W_N^{(N-1)(N-1)}) $$

which is equivalent to 

$$ \begin{bmatrix} X[0] \\ X[1] \\ \vdots \\ X[N-1] \end{bmatrix} = 
\frac{1}{\sqrt{N}} 

\begin{bmatrix} 
1 & 1 & 1 & ... & 1 \\
1 & W_N & W_N^2 & ... & W_N^{N-1} \\
\vdots & \vdots & \vdots & ... & \vdots \\
1 & W_N^{N-1} & W_N^{2(N-1)} & ... & W_N^{(N-1)(N-1)} 
\end{bmatrix}

\begin{bmatrix}
x[0] \\
x[1] \\
x[2] \\
\vdots \\
x[N-1] 
\end{bmatrix}
$$

The synthesis formula can be similarly written as a matrix multiplication:

$$

\begin{bmatrix}
x[0] \\
x[1] \\
\vdots \\
x[N-1] 
\end{bmatrix}
= 
\frac{1}{\sqrt{N}} 
\begin{bmatrix} 
1 & 1 & 1 & ... & 1 \\
1 & W_N^* & {W_N^*}^2 & ... & {W_N^*}^{N-1} \\
\vdots & \vdots & \vdots & ... & \vdots \\
1 & {W_N^*}^{N-1} & {W_N^*}^{2(N-1)} & ... & {W_N^*}^{(N-1)(N-1)} 
\end{bmatrix}

\begin{bmatrix} X[0] \\ X[1] \\ \vdots \\ X[N-1] \end{bmatrix} 

$$

From the synthesis formulation above, one can see that the Fourier coefficients can be interpeted as coordinates with the columns as the basis vectors. The basis vectors in the Fourier consist of various sinusoidal form. Below are pictured the Fourier basis vectors for $N = 16$

<figure>
<img src="{{site.baseurl}}/images/post_im/circulant/basis.png">
  <figcaption>Fourier Basis for $N=16$ (The real part in blue, imaginary part in orange)</figcaption>
</figure>


## Circulant Matrices  

$$
\begin{bmatrix}
 c_0    & c_{n-1} & \cdots  & c_1   \\
 c_1    & c_0     & \cdots  & c_2   \\
 \vdots &         & \ddots & \vdots\\
 c_{n-1}& c_{n-2} & \cdots  & c_0   
\end{bmatrix}
$$

# Graphs 

Hol up!,

<figure>
<img src="{{site.baseurl}}/images/post_im/circulant/cycle.png">
  <figcaption>Cycle Graph</figcaption>
</figure>



# References:

<a id="ref_1"></a>
1. Oppenheim, Alan V., John R. Buck, and Ronald W. Schafer. Discrete-time signal processing. Vol. 2. Upper Saddle River, NJ: Prentice Hall, 2001.
<a id="ref_2"></a>
2. [Deriving convolution from first principles](https://towardsdatascience.com/deriving-convolution-from-first-principles-4ff124888028)
3. [Ortega, Antonio, et al. "Graph signal processing: Overview, challenges, and applications." Proceedings of the IEEE 106.5 (2018): 808-828.](https://arxiv.org/pdf/1712.00468.pdf)